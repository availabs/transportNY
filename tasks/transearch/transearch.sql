with roadnetwork as 
(
select
	lident || '_' || heading as rd,
	lident, 
	heading,
	round(sum(case when stcc = '1' then total_tonnage else 0 end), 1) as stcc_1_tonnage, 
	round(sum(case when stcc = '10' then total_tonnage else 0 end), 1) as stcc_10_tonnage, 
	round(sum(case when stcc = '11' then total_tonnage else 0 end), 1) as stcc_11_tonnage, 
	round(sum(case when stcc = '13' then total_tonnage else 0 end), 1) as stcc_13_tonnage, 
	round(sum(case when stcc = '14' then total_tonnage else 0 end), 1) as stcc_14_tonnage, 
	round(sum(case when stcc = '19' then total_tonnage else 0 end), 1) as stcc_19_tonnage, 
	round(sum(case when stcc = '20' then total_tonnage else 0 end), 1) as stcc_20_tonnage, 
	round(sum(case when stcc = '20 2' then total_tonnage else 0 end), 1) as stcc_2002_tonnage, 
	round(sum(case when stcc = '21' then total_tonnage else 0 end), 1) as stcc_21_tonnage, 
	round(sum(case when stcc = '22' then total_tonnage else 0 end), 1) as stcc_22_tonnage, 
	round(sum(case when stcc = '23' then total_tonnage else 0 end), 1) as stcc_23_tonnage, 
	round(sum(case when stcc = '24' then total_tonnage else 0 end), 1) as stcc_24_tonnage, 
	round(sum(case when stcc = '25' then total_tonnage else 0 end), 1) as stcc_25_tonnage, 
	round(sum(case when stcc = '26' then total_tonnage else 0 end), 1) as stcc_26_tonnage, 
	round(sum(case when stcc = '27' then total_tonnage else 0 end), 1) as stcc_27_tonnage, 
	round(sum(case when stcc = '28' then total_tonnage else 0 end), 1) as stcc_28_tonnage, 
	round(sum(case when stcc = '29' then total_tonnage else 0 end), 1) as stcc_29_tonnage, 
	round(sum(case when stcc = '30' then total_tonnage else 0 end), 1) as stcc_30_tonnage, 
	round(sum(case when stcc = '31' then total_tonnage else 0 end), 1) as stcc_31_tonnage, 
	round(sum(case when stcc = '32' then total_tonnage else 0 end), 1) as stcc_32_tonnage, 
	round(sum(case when stcc = '32 4' then total_tonnage else 0 end), 1) as stcc_3204_tonnage, 
	round(sum(case when stcc = '33' then total_tonnage else 0 end), 1) as stcc_33_tonnage, 
	round(sum(case when stcc = '34' then total_tonnage else 0 end), 1) as stcc_34_tonnage, 
	round(sum(case when stcc = '35' then total_tonnage else 0 end), 1) as stcc_35_tonnage, 
	round(sum(case when stcc = '36' then total_tonnage else 0 end), 1) as stcc_36_tonnage, 
	round(sum(case when stcc = '37' then total_tonnage else 0 end), 1) as stcc_37_tonnage, 
	round(sum(case when stcc = '38' then total_tonnage else 0 end), 1) as stcc_38_tonnage, 
	round(sum(case when stcc = '39' then total_tonnage else 0 end), 1) as stcc_39_tonnage, 
	round(sum(case when stcc = '40' then total_tonnage else 0 end), 1) as stcc_40_tonnage, 
	round(sum(case when stcc = '41' then total_tonnage else 0 end), 1) as stcc_41_tonnage, 
	round(sum(case when stcc = '42' then total_tonnage else 0 end), 1) as stcc_42_tonnage, 
	round(sum(case when stcc = '46 1' then total_tonnage else 0 end), 1) as stcc_4601_tonnage, 
	round(sum(case when stcc = '50' then total_tonnage else 0 end), 1) as stcc_50_tonnage, 
	round(sum(case when stcc = '50 1' then total_tonnage else 0 end), 1) as stcc_5001_tonnage, 
	round(sum(case when stcc = '50 19' then total_tonnage else 0 end), 1) as stcc_5019_tonnage, 
	round(sum(case when stcc = '50 2' then total_tonnage else 0 end), 1) as stcc_5002_tonnage, 
	round(sum(case when stcc = '8' then total_tonnage else 0 end), 1) as stcc_8_tonnage, 
	round(sum(case when stcc = '9' then total_tonnage else 0 end), 1) as stcc_9_tonnage,
	round(sum(case when stcc = '1' then total_value else 0 end), 1) as stcc_1_value,
	round(sum(case when stcc = '10' then total_value else 0 end), 1) as stcc_10_value,
	round(sum(case when stcc = '11' then total_value else 0 end), 1) as stcc_11_value,
	round(sum(case when stcc = '13' then total_value else 0 end), 1) as stcc_13_value,
	round(sum(case when stcc = '14' then total_value else 0 end), 1) as stcc_14_value,
	round(sum(case when stcc = '19' then total_value else 0 end), 1) as stcc_19_value,
	round(sum(case when stcc = '20' then total_value else 0 end), 1) as stcc_20_value,
	round(sum(case when stcc = '20 2' then total_value else 0 end), 1) as stcc_2002_value,
	round(sum(case when stcc = '21' then total_value else 0 end), 1) as stcc_21_value,
	round(sum(case when stcc = '22' then total_value else 0 end), 1) as stcc_22_value,
	round(sum(case when stcc = '23' then total_value else 0 end), 1) as stcc_23_value,
	round(sum(case when stcc = '24' then total_value else 0 end), 1) as stcc_24_value,
	round(sum(case when stcc = '25' then total_value else 0 end), 1) as stcc_25_value,
	round(sum(case when stcc = '26' then total_value else 0 end), 1) as stcc_26_value,
	round(sum(case when stcc = '27' then total_value else 0 end), 1) as stcc_27_value,
	round(sum(case when stcc = '28' then total_value else 0 end), 1) as stcc_28_value,
	round(sum(case when stcc = '29' then total_value else 0 end), 1) as stcc_29_value,
	round(sum(case when stcc = '30' then total_value else 0 end), 1) as stcc_30_value,
	round(sum(case when stcc = '31' then total_value else 0 end), 1) as stcc_31_value,
	round(sum(case when stcc = '32' then total_value else 0 end), 1) as stcc_32_value,
	round(sum(case when stcc = '32 4' then total_value else 0 end), 1) as stcc_3204_value,
	round(sum(case when stcc = '33' then total_value else 0 end), 1) as stcc_33_value,
	round(sum(case when stcc = '34' then total_value else 0 end), 1) as stcc_34_value,
	round(sum(case when stcc = '35' then total_value else 0 end), 1) as stcc_35_value,
	round(sum(case when stcc = '36' then total_value else 0 end), 1) as stcc_36_value,
	round(sum(case when stcc = '37' then total_value else 0 end), 1) as stcc_37_value,
	round(sum(case when stcc = '38' then total_value else 0 end), 1) as stcc_38_value,
	round(sum(case when stcc = '39' then total_value else 0 end), 1) as stcc_39_value,
	round(sum(case when stcc = '40' then total_value else 0 end), 1) as stcc_40_value,
	round(sum(case when stcc = '41' then total_value else 0 end), 1) as stcc_41_value,
	round(sum(case when stcc = '42' then total_value else 0 end), 1) as stcc_42_value,
	round(sum(case when stcc = '46 1' then total_value else 0 end), 1) as stcc_4601_value,
	round(sum(case when stcc = '50' then total_value else 0 end), 1) as stcc_50_value,
	round(sum(case when stcc = '50 1' then total_value else 0 end), 1) as stcc_5001_value,
	round(sum(case when stcc = '50 19' then total_value else 0 end), 1) as stcc_5019_value,
	round(sum(case when stcc = '50 2' then total_value else 0 end), 1) as stcc_5002_value,
	round(sum(case when stcc = '8' then total_value else 0 end), 1) as stcc_8_value,
	round(sum(case when stcc = '9' then total_value else 0 end), 1) as stcc_9_value,
	st_reverse(wkb_geometry)
FROM gis_datasets.s189_v193_transearch_routes_2021_new_commodity_sw
group by 1,2,3,wkb_geometry 
union
SELECT 
	lident || '_' || heading as rd, 
	lident, 
	heading,
	round(sum(case when stcc = '1' then total_tonnage else 0 end), 1) as stcc_1_tonnage, 
	round(sum(case when stcc = '10' then total_tonnage else 0 end), 1) as stcc_10_tonnage, 
	round(sum(case when stcc = '11' then total_tonnage else 0 end), 1) as stcc_11_tonnage, 
	round(sum(case when stcc = '13' then total_tonnage else 0 end), 1) as stcc_13_tonnage, 
	round(sum(case when stcc = '14' then total_tonnage else 0 end), 1) as stcc_14_tonnage, 
	round(sum(case when stcc = '19' then total_tonnage else 0 end), 1) as stcc_19_tonnage, 
	round(sum(case when stcc = '20' then total_tonnage else 0 end), 1) as stcc_20_tonnage, 
	round(sum(case when stcc = '20 2' then total_tonnage else 0 end), 1) as stcc_2002_tonnage, 
	round(sum(case when stcc = '21' then total_tonnage else 0 end), 1) as stcc_21_tonnage, 
	round(sum(case when stcc = '22' then total_tonnage else 0 end), 1) as stcc_22_tonnage, 
	round(sum(case when stcc = '23' then total_tonnage else 0 end), 1) as stcc_23_tonnage, 
	round(sum(case when stcc = '24' then total_tonnage else 0 end), 1) as stcc_24_tonnage, 
	round(sum(case when stcc = '25' then total_tonnage else 0 end), 1) as stcc_25_tonnage, 
	round(sum(case when stcc = '26' then total_tonnage else 0 end), 1) as stcc_26_tonnage, 
	round(sum(case when stcc = '27' then total_tonnage else 0 end), 1) as stcc_27_tonnage, 
	round(sum(case when stcc = '28' then total_tonnage else 0 end), 1) as stcc_28_tonnage, 
	round(sum(case when stcc = '29' then total_tonnage else 0 end), 1) as stcc_29_tonnage, 
	round(sum(case when stcc = '30' then total_tonnage else 0 end), 1) as stcc_30_tonnage, 
	round(sum(case when stcc = '31' then total_tonnage else 0 end), 1) as stcc_31_tonnage, 
	round(sum(case when stcc = '32' then total_tonnage else 0 end), 1) as stcc_3204_tonnage, 
	round(sum(case when stcc = '32 4' then total_tonnage else 0 end), 1) as stcc_3204_tonnage, 
	round(sum(case when stcc = '33' then total_tonnage else 0 end), 1) as stcc_33_tonnage, 
	round(sum(case when stcc = '34' then total_tonnage else 0 end), 1) as stcc_34_tonnage, 
	round(sum(case when stcc = '35' then total_tonnage else 0 end), 1) as stcc_35_tonnage, 
	round(sum(case when stcc = '36' then total_tonnage else 0 end), 1) as stcc_36_tonnage, 
	round(sum(case when stcc = '37' then total_tonnage else 0 end), 1) as stcc_37_tonnage, 
	round(sum(case when stcc = '38' then total_tonnage else 0 end), 1) as stcc_38_tonnage, 
	round(sum(case when stcc = '39' then total_tonnage else 0 end), 1) as stcc_39_tonnage, 
	round(sum(case when stcc = '40' then total_tonnage else 0 end), 1) as stcc_40_tonnage, 
	round(sum(case when stcc = '41' then total_tonnage else 0 end), 1) as stcc_41_tonnage, 
	round(sum(case when stcc = '42' then total_tonnage else 0 end), 1) as stcc_42_tonnage, 
	round(sum(case when stcc = '46 1' then total_tonnage else 0 end), 1) as stcc_4601_tonnage, 
	round(sum(case when stcc = '50' then total_tonnage else 0 end), 1) as stcc_50_tonnage, 
	round(sum(case when stcc = '50 1' then total_tonnage else 0 end), 1) as stcc_5001_tonnage, 
	round(sum(case when stcc = '50 19' then total_tonnage else 0 end), 1) as stcc_5019_tonnage, 
	round(sum(case when stcc = '50 2' then total_tonnage else 0 end), 1) as stcc_5002_tonnage, 
	round(sum(case when stcc = '8' then total_tonnage else 0 end), 1) as stcc_8_tonnage, 
	round(sum(case when stcc = '9' then total_tonnage else 0 end), 1) as stcc_9_tonnage,
	round(sum(case when stcc = '1' then total_value else 0 end), 1) as stcc_1_value,
	round(sum(case when stcc = '10' then total_value else 0 end), 1) as stcc_10_value,
	round(sum(case when stcc = '11' then total_value else 0 end), 1) as stcc_11_value,
	round(sum(case when stcc = '13' then total_value else 0 end), 1) as stcc_13_value,
	round(sum(case when stcc = '14' then total_value else 0 end), 1) as stcc_14_value,
	round(sum(case when stcc = '19' then total_value else 0 end), 1) as stcc_19_value,
	round(sum(case when stcc = '20' then total_value else 0 end), 1) as stcc_20_value,
	round(sum(case when stcc = '20 2' then total_value else 0 end), 1) as stcc_2002_value,
	round(sum(case when stcc = '21' then total_value else 0 end), 1) as stcc_21_value,
	round(sum(case when stcc = '22' then total_value else 0 end), 1) as stcc_22_value,
	round(sum(case when stcc = '23' then total_value else 0 end), 1) as stcc_23_value,
	round(sum(case when stcc = '24' then total_value else 0 end), 1) as stcc_24_value,
	round(sum(case when stcc = '25' then total_value else 0 end), 1) as stcc_25_value,
	round(sum(case when stcc = '26' then total_value else 0 end), 1) as stcc_26_value,
	round(sum(case when stcc = '27' then total_value else 0 end), 1) as stcc_27_value,
	round(sum(case when stcc = '28' then total_value else 0 end), 1) as stcc_28_value,
	round(sum(case when stcc = '29' then total_value else 0 end), 1) as stcc_29_value,
	round(sum(case when stcc = '30' then total_value else 0 end), 1) as stcc_30_value,
	round(sum(case when stcc = '31' then total_value else 0 end), 1) as stcc_31_value,
	round(sum(case when stcc = '32' then total_value else 0 end), 1) as stcc_3204_value,
	round(sum(case when stcc = '32 4' then total_value else 0 end), 1) as stcc_3204_value,
	round(sum(case when stcc = '33' then total_value else 0 end), 1) as stcc_33_value,
	round(sum(case when stcc = '34' then total_value else 0 end), 1) as stcc_34_value,
	round(sum(case when stcc = '35' then total_value else 0 end), 1) as stcc_35_value,
	round(sum(case when stcc = '36' then total_value else 0 end), 1) as stcc_36_value,
	round(sum(case when stcc = '37' then total_value else 0 end), 1) as stcc_37_value,
	round(sum(case when stcc = '38' then total_value else 0 end), 1) as stcc_38_value,
	round(sum(case when stcc = '39' then total_value else 0 end), 1) as stcc_39_value,
	round(sum(case when stcc = '40' then total_value else 0 end), 1) as stcc_40_value,
	round(sum(case when stcc = '41' then total_value else 0 end), 1) as stcc_41_value,
	round(sum(case when stcc = '42' then total_value else 0 end), 1) as stcc_42_value,
	round(sum(case when stcc = '46 1' then total_value else 0 end), 1) as stcc_4601_value,
	round(sum(case when stcc = '50' then total_value else 0 end), 1) as stcc_50_value,
	round(sum(case when stcc = '50 1' then total_value else 0 end), 1) as stcc_5001_value,
	round(sum(case when stcc = '50 19' then total_value else 0 end), 1) as stcc_5019_value,
	round(sum(case when stcc = '50 2' then total_value else 0 end), 1) as stcc_5002_value,
	round(sum(case when stcc = '8' then total_value else 0 end), 1) as stcc_8_value,
	round(sum(case when stcc = '9' then total_value else 0 end), 1) as stcc_9_value,
	wkb_geometry
	FROM gis_datasets.s188_v192_transearch_routes_2021_new_commodity_ne
	group by 1,2,3,wkb_geometry
) 
select  row_number() over () as id  from roadnetwork;
